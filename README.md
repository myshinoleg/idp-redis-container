# redis-container

# Redis

### Типы данных: 
- Строки (strings). Базовый тип данных Redis. Строки в Redis бинарно-безопасны, могут использоваться так же как числа, ограничены размером 512 Мб.
- Списки (lists). Классические списки строк, упорядоченные в порядке вставки, которая возможна как со стороны головы, так и со стороны хвоста списка. Максимальное количество элементов — 232 — 1.
- Множества (sets). Множества строк в математическом понимании: не упорядочены, поддерживают операции вставки, проверки вхождения элемента, пересечения и разницы множеств. Максимальное количество элементов — 232 — 1.
- Хеш-таблицы (hashes). Классические хеш-таблицы или ассоциативные массивы. Максимальное количество пар «ключ-значение» — 232 — 1.
- Упорядоченные множества (sorted sets). Упорядоченное множество отличается от обычного тем, что его элементы упорядочены по особому параметру «score».

### Основные консольные команды для работы через redis-cli
    установить значение - set [key] [value]
    получить значение - get [key]
    удалить значение - del [key]
    переименовать - rename [key] [new key]
    проверить наличие - exists [key]
    время жизни - ttl [key]
    задать время жизни - expire [key] [value]

### transaction's
    MULTI — начать запись команд для транзакции.
    EXEC — выполнить записанные команды.
    DISCARD — удалить все записанные команды.
    WATCH — команда, обеспечивающая поведение типа «check-and-set» (CAS) — транзакция выполняется только в случае, если другие клиенты не изменили значение переменной. Иначе EXEC не выполнит записанные команды.

### строки 
    append [key] [value] - добавить в конец строки
    strlen [key] - длина строки
    getrange [key] [from] [to] - получить из диапазона
    setrange [key] [from] [value] - установить значение начиная с позиции 

### списки
    rpush [key] [value] - добавить в список
    lrange [key] [from] [to] - вывести значения из промежутка 
    llen [key] - количество элементов в списке
    lpop [key] - получить элемент из начала списка (удаляется)

### множества
    sadd [key] [value] - добавить элемент в множество
    scard [key] - количество элементов
    sdiff [key 1] [key 2] - разница между множествами
    sdiffstore [key 1] [key 2] [result key] - сохранить разницу между 2 множествами в новое множество
    sinter [key 1] [key 2] - пересечение множеств
    sismember [key] [value] - проверить наличие элемента в множестве
    smove [key 1] [key 2] [value] - перенести значение из одного множества в другое
    spop - [key] - получить последний элемент множества
    sunion [key 1] [key 2] - объединить множества
    sunionstore [key 1] [key 2] [result key] - сохранить объединение множеств в новое
    zadd [key] [value] - добавить значение в упорядоченное множество

### хеш-таблицы
    hset [key] [hash] [value] - установить хеш и значение 
    hkeys [key] - ключи таблицы
    hvals [key] - значения таблицы
    hgetall - получить все данные хеш-таблицы
    hdel [key] [hash] - удалить значение


# MongoDB

### Работа с БД

    show dbs - список БД
    db - текущая бд
    show collections - список коллекций в текущей бд
    db.[collectionName].insert([data in JSON]) - вставка документа в коллекцию
    db.createCollection([name], [options]) - создание новой коллекции
    db.users.find() - == select * from
    db.users.find({name: «Oleg»}) - select * from collection where name = "Oleg"
    function [fun name](n) { return n*n; } - создание новой функции с последующим применением
    
    db.[coolection].find().
                    limit(3) - ограничим выборку тремя документами
                    skip(3) - пропустим первые три записи
                    sort({name: 1}) - сортировать: по возрастанию (1) или по убыванию (-1)
    
     db.[collection].distinct(«name») - только уникальные различающиеся значения для одного из полей документа
    
### уловные операторы 

    $gt (больше чем)
    $lt (меньше чем)
    $gte (больше или равно)
    $lte (меньше или равно)
    $ne, который извлекает все документы, не соответствующие некоторому условию
    $in определяет массив возможных выражений
    $all — требует, чтобы документы имели весь определяемый набор выражений
    $or - определяет набор пар ключ-значение, которые должны иметься в документе
    $exists — только те документы, в которых определенный ключ присутствует или отсутствует
    $regex - db.[collection].find ({name: {$regex:»b»}}) задает регулярное выражение, которому должно соответствовать значение поля
    
### обновление данных
    save - В этот документ в качестве поля можно передать параметр _id. Если метод находит документ с таким значением _id, то документ обновляется. Если же с подобным _id нет документов, то документ вставляется.
    
    update - более детальная работа с обновлением
    Для удаления отдельного ключа используется оператор $unset: 
        db.[collection].update({name : «Oleg»}, {$unset: {salary: 1}})

### Удаление данных
    db.[collection].remove({name : «oleg»}) - удаляет документ
    db.[collection].remove({}) - удаляет все документы в коллекции
    db.[collection].drop() - удаляет коллекцию
    db.dropDatabase() - удаляет базу

### связывание
     { "$ref" : название_коллекции, "$id": значение [, "$db" : название_бд ]}***
    
    Первый параметр $ref указывает на коллекцию, где хранится связанный документ.
    Второй параметр указывает на значение, которое и будет представлять что-то типа внешнего ключа.
    Третий необязательный параметр указывает на базу данных.
    
### Индексы
    db.[collection].createIndex({"name" : 1}) - создание
    db.[collection].dropIndex("name_1") - удаление
    db.[collection].getIndexes()