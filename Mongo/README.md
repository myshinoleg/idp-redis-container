# MongoDB

### Types
    String: строковый тип данных, (для строк используется кодировка UTF-8)
    Array (массив): тип данных для хранения массивов элементов
    Binary data (двоичные данные): тип для хранения данных в бинарном формате
    Boolean: булевый тип данных, хранящий логические значения TRUE или FALSE, например, {"married": FALSE}
    Date: хранит дату в формате времени Unix
    Double: числовой тип данных для хранения чисел с плавающей точкой
    Integer: используется для хранения целочисленных значений размером 32 бита, например, {"age": 29}
    Long: используется для хранения целочисленных значений размером 64 бита
    JavaScript: тип данных для хранения кода javascript
    Min key/Max key: используются для сравнения значений с наименьшим/наибольшим элементов BSON
    Null: тип данных для хранения значения Null
    Object: объект, который содержит набор свойств
    ObjectId: тип данных для хранения id документа
    Regular expression: применяется для хранения регулярных выражений
    Decimal128: тип данных для хранения десятичных дробных чисел размером 128 бит, которые позволяют решить проблемы с проблемой точности вычислений при использовании дробных чисел, которые представляют тип Double.
    Timestamp: применяется для хранения времени

### Работа с БД

    show dbs - список БД
    db - текущая бд
    show collections - список коллекций в текущей бд
    db.[collectionName].insertOne([data in JSON]) - вставка документа в коллекцию
    db.createCollection([name], [options]) - создание новой коллекции
    db.users.find() - == select * from
    db.users.find({name: «Oleg»}) - select * from collection where name = "Oleg"
    function [fun name](n) { return n*n; } - создание новой функции с последующим применением
    
    db.[coolection].find().
                    limit(3) - ограничим выборку тремя документами
                    skip(3) - пропустим первые три записи
                    sort({name: 1}) - сортировать: по возрастанию (1) или по убыванию (-1)
    
    db.[collection].distinct(«name») - только уникальные различающиеся значения для одного из полей документа
    db.users.deleteOne({name : "Oleg"})

### уловные операторы 

    $gt (больше чем)
    $lt (меньше чем)
    $gte (больше или равно)
    $lte (меньше или равно)
    $ne, который извлекает все документы, не соответствующие некоторому условию
    $in определяет массив возможных выражений
    $all — требует, чтобы документы имели весь определяемый набор выражений
    $or - определяет набор пар ключ-значение, которые должны иметься в документе
    $and представляет логическую операцию И (логическое умножение)
        {$and : [{name: "Oleg"}, {skill: php}]}
    $exists — только те документы, в которых определенный ключ присутствует или отсутствует
    $regex - db.[collection].find ({name: {$regex:»b»}}) задает регулярное выражение, которому должно соответствовать значение поля
    $elemMatch позволяет выбрать документы, в которых массивы содержат элементы, попадающие под определенные условия
    $size используется для нахождения документов, в которых массивы имеют число элементов, равным значению $size
    $type извлекает только те документы, в которых определенный ключ имеет значение определенного типа, например, строку или число


### обновление данных
    save - В этот документ в качестве поля можно передать параметр _id. Если метод находит документ с таким значением _id, то документ обновляется. Если же с подобным _id нет документов, то документ вставляется.
    
    update - более детальная работа с обновлением
    Для удаления отдельного ключа используется оператор $unset: 
        db.[collection].update({name : «Oleg»}, {$unset: {salary: 1}})

### Удаление данных
    db.[collection].remove({name : «oleg»}) - удаляет документ
    db.[collection].remove({}) - удаляет все документы в коллекции
    db.[collection].drop() - удаляет коллекцию
    db.dropDatabase() - удаляет базу

### связывание
     { "$ref" : название_коллекции, "$id": значение [, "$db" : название_бд ]}***
    
    Первый параметр $ref указывает на коллекцию, где хранится связанный документ.
    Второй параметр указывает на значение, которое и будет представлять что-то типа внешнего ключа.
    Третий необязательный параметр указывает на базу данных.
    
### Индексы
    db.[collection].createIndex({"name" : 1}) - создание
    db.[collection].dropIndex("name_1") - удаление
    db.[collection].getIndexes()